window.Behave=(function(e){var d="undefined",h="function",c="object",f="BHVInstance";if(typeof window.$===d){return null}var g=function(i){return typeof i===h};function a(j,i){this.BHV=j;this.$element=i;this.currentState="";if(!this.BHV.eventsAreSane()){return false}this.setEvents();this.setInitialState();i.data(f,this)}a.prototype={log:function(){if(!this.BHV.options.debug){return}Array.prototype.unshift.call(arguments,"Behave>");console.log.apply(console,arguments)},eventIsActive:function(i){return this.BHV._states[this.getState()].disableEvents.indexOf(i)<0},setEvents:function(){var k=this.BHV._events,j=this;for(var l in k){(function(){var i=l;j.$element.bind(i,function(n){var m=j.eventIsActive(i);j.log("called: ",i,m?" (active)":" (not active)");if(m){arguments[arguments.length]=j.$element;return k[i].apply(this,arguments)}else{n.preventDefault()}})})()}},setInitialState:function(i){this.currentState=this.BHV.getInitialState();if(g(this.currentState)){this.currentState=this.currentState.call(this.$element.get())}var j=this.BHV._states[this.currentState];this.classes("addClass",this.currentState);this.callCallback(j.stateOn)},inStates:function(i){return i.indexOf(this.getState())>=0},getState:function(){return this.currentState},state:function(i){if(typeof i===d||!i){return this.getState()}else{return this.setState(i)}},setState:function(k){this.log("setting state to: "+k);if(typeof this.BHV._states[k]===d){return false}var i=this.BHV._states[this.currentState];var j=this.BHV._states[k];this.callCallback(i.stateOff);this.switchClasses(this.currentState,k);this.callCallback(j.stateOn);this.currentState=k},callCallback:function(i){if(g(i)){this.log("calling callback: ",i);i.call(this,this.$element)}},classes:function(j,k){var i=this.BHV._states[k].classes;this.$element[j](i.join(" "))},switchClasses:function(j,i){this.classes("removeClass",j);this.classes("addClass",i)}};function b(i){this.options=e.extend({},{debug:false,initialState:null,rootClass:""},i);this._states={};this._events={};this._instances=[];this._current_object=null}b.prototype={eventsAreSane:function(){for(var n in this._states){var m=this._states[n];var l=m.disableEvents;for(var j=0;j<l.length;j++){if(typeof this._events[l[j]]==="undefined"){this.log("events are NOT sane: ",l[j]," is nowhere to be found...");return false}}}return true},getInitialState:function(){if(this.options.initialState){return this.options.initialState}for(var j in this._states){return this.options.initialState=this._states[j]}},addState:function(j,i){if(typeof this._states[j]!==d){return false}this._states[j]=e.extend({},{classes:[],disableEvents:[],stateOn:null,stateOff:null},i);return true},addStates:function(j){for(var k in j){this.addState(k,j[k])}return true},addEvent:function(i,j){if(!g(j)){return false}if(typeof this._events[i]!==d){return false}this._events[i]=j},addEvents:function(k){for(var j in k){this.addEvent(j,k[j])}return true},addCollection:function(j){if(typeof j.data(f)==="object"&&j.data(f).currentState!==d){return false}var i=this;j.each(function(m,l){var k=new a(i,e(l));i._instances.push(k)});return true}};e.fn.state=function(){var i=this.data(f);if(typeof i===d||i.currentState===d){return false}return i.state.apply(i,arguments)};e.fn.inStates=function(){var i=this.data(f);if(typeof i===d||i.currentState===d){return false}return i.inStates.apply(i,arguments)};return b})(jQuery);